# Generated by fusen: do not edit by hand

#' Title
#' 
#' Description
#' 
#' @param .data A dataframe
#' @param .cols_extact Columns that need extact matching
#'
#' @return A dataframe
#' 
#' @export
scores_data <- function(.data, .cols_extact = c()) {
  id_s <- id_t <- NULL
  tab0_ <- tab1_ <- .data
  cols_ <- colnames(.data)
  sim_  <- cols_[startsWith(cols_, "sim")]
  uni_  <- cols_[startsWith(cols_, "uni")]
  all_  <- c(sim_, uni_)
  
  
  if (length(.cols_exact) > 0) {
    for (i in .cols_exact) {
      tab1_[[i]][tab1_[[i]] != 1] <- -1000
    }
  }
  
  .data %>%
    dplyr::select(id_s, id_t) %>%
    dplyr::mutate(
      mean_sim0 = rowMeans(as.matrix(tab0_[, sim_]), na.rm = TRUE),
      mean_all0 = rowMeans(as.matrix(tab0_[, all_]), na.rm = TRUE),
      mean_sim1 = rowMeans(as.matrix(tab1_[, sim_]), na.rm = TRUE),
      mean_all1 = rowMeans(as.matrix(tab1_[, all_]), na.rm = TRUE)
    ) %>%
    dplyr::mutate(
      dplyr::across(dplyr::starts_with("mean"), ~ dplyr::if_else(. < 0, -1, .))
    )
  
}
