# Generated by fusen: do not edit by hand

#' Title
#' 
#' Description
#' 
#' @param .s 
#' The Source Dataframe. 
#' Must contain a unique column id and the columns you want to match on
#' @param .t 
#' The Traget Dataframe. 
#' Must contain a unique column id and the columns you want to match on
#' @param .cols 
#' The column names to match as character vector
#' @param .max_match 
#' Maximum number of matches to return (Default = 10)
#' @param .min_sim 
#' Minimum Similarity as defined by the chosen method
#' @param .method 
#' One of "osa", "lv", "dl", "hamming", "lcs", "qgram", "cosine", "jaccard", "jw", "soundex"
#' See stringdist package
#'
#' @return A Dataframe
#' 
#' @export
#' @examples
#' library(Rmatch)
#' match_data(source[1:100, ], target[1:1000, ], c("name", "city"), .min_sim = 0)
match_data <- function(.s, .t, .cols, .max_match = 10, .min_sim = .8, .method = "osa") {
  sim <- NULL

  tab_ <- match_col(.s, .t, .cols[1], .max_match, .min_sim, .method)
  
  if (length(.cols) > 1) {
    tab_ <- dplyr::rename(tab_, sim1 = sim)
    s_ <- dplyr::left_join(tab_, .s, by = c("id_s" = "id"))
    t_ <- dplyr::left_join(tab_, .t, by = c("id_t" = "id"))
    
    for (i in 2:length(.cols)) {
      a <- stringdist::stringsim(s_[[.cols[i]]], t_[[.cols[i]]], .method)
      
      tab_[[paste0("sim", i)]] <- stringdist::stringsim(s_[[.cols[i]]], t_[[.cols[i]]], .method)
    }
    
  }
  
  return(tab_)

}
